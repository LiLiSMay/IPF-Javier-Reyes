<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mario Jump Game</title>
    <style>
        :root {
            --bg-color: #87CEEB;
            --accent: #D2691E;
            --gold: #FFD700;
            --box-brown-dark: #654321;
            --box-brown-light-start: #CD853F;
            --box-brown-light-end: #8B4513;
            --font-family: Arial, sans-serif;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family);
            overflow: hidden;
            background: var(--bg-color);
        }

        #gameContainer {
            position: relative;
            width: 100vw;
            height: 100vh;
            background-image: url('img/FondoOrignal.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            overflow: hidden;
        }

        #backgroundImage {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            pointer-events: none;
            z-index: 0;
        }

        .jump-button {
            position: absolute;
            bottom: 3%;
            left: 50%;
            transform: translateX(-50%);
            width: 140px;
            height: 70px;
            background-image: url('img/icono.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            border: none;
            cursor: pointer;
            transition: transform 0.1s;
            z-index: 10;
            -webkit-appearance: none;
            appearance: none;
            background-color: transparent;
            touch-action: manipulation;
        }

        .jump-button:hover {
            transform: translateX(-50%) scale(1.05);
        }

        .jump-button:active {
            transform: translateX(-50%) scale(0.95);
        }

        .jump-button:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(210, 105, 30, 0.15);
        }

        .message {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.98);
            border: 4px solid var(--gold);
            border-radius: 12px;
            padding: 20px 30px;
            max-width: 600px;
            width: 90vw;
            max-height: 60vh;
            overflow-y: auto;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            z-index: 10;
            opacity: 0;
            animation: showMessage 0.3s ease-in-out forwards;
            font-size: 14px;
            line-height: 1.6;
            pointer-events: auto;
        }

        @keyframes jump {
            0% {
                bottom: 5.5%;
            }

            /* El bloque está en top: 65vh, Mario inicia en bottom: 5.5% (aprox 5.5vh), altura de Mario 150px */
            /* Para que el tope de Mario coincida con el tope del bloque, el salto debe ser a 65vh - 150px (altura Mario) */
            50% {
                bottom: calc(38vh - 150px);
            }

            100% {
                bottom: 5.5%;
            }
        }

        .block {
            position: absolute;
            top: 65vh;
            left: 50%;
            transform: translateX(-50%);
            width: 64px;
            height: 64px;
            background: url('img/bloque.png') no-repeat center center / contain;
            z-index: 4;
        }

        .block.hit {
            filter: brightness(0.7);
        }

        #mario {
            position: absolute;
            bottom: 5.5%;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 65px;
            bottom: 10%;
            background-image: url('img/Mario-Espera-Photoroom.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            transition: bottom 0.3s ease-out, left 0.3s ease-out;
            z-index: 5;
            display: block;
            will-change: bottom, transform;
        }

        #mario.jumping {
            animation: jump 0.8s ease-in-out;
            background-image: url('img/Mario-Salta-Photoroom.png');
            width: 80px;
            height: 110px;
            display: block;
        }

        /* Reglas responsivas para pantallas pequeñas (ej. 393x852) */
        @media (max-width: 420px) {
            .message {
                width: calc(100% - 32px);
                left: 50%;
                transform: translateX(-50%);
                padding: 14px 16px;
                font-size: 13px;
                max-height: 70vh;
            }

            #mario {
                width: 30px;
                height: 110px;
                bottom: 4%;
            }

            .jump-button {
                width: 120px;
                height: 60px;
                bottom: 2.5%;
            }
        }

        @keyframes showMessage {
            0% {
                opacity: 0;
                transform: translateX(-50%) translateY(20px);
            }

            100% {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--accent);
            color: white;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.3s, transform 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
            pointer-events: auto;
        }

        .close-btn:hover {
            background: #A0522D;
            transform: scale(1.1);
        }

        .message h3 {
            color: var(--accent);
            margin-bottom: 10px;
            font-size: 18px;
            border-bottom: 2px solid var(--gold);
            padding-bottom: 8px;
        }

        .message ul {
            list-style: none;
            padding-left: 0;
            margin-top: 8px;
        }

        .message li {
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
            color: #333;
        }

        .message li::before {
            content: '•';
            position: absolute;
            left: 0;
            color: var(--accent);
            font-weight: bold;
        }

        .logo-container {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(240, 221, 9, 0.98);
            border: 4px solid var(--gold);
            border-radius: 50%;
            padding: 15px;
            z-index: 3;
            width: 210px;
            height: 210px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo-container img {
            width: 200px;
            height: auto;
            display: block;
            margin: 0 auto;
        }
    </style>
</head>

<body>
    <div id="gameContainer">
        <div class="logo-container">
            <img src="img/Sigla.png" alt="Logo">
        </div>

        <div class="block" id="block"></div>

        <div id="mario"></div>

        <button class="jump-button" id="jumpBtn"></button>
    </div>

    <script type="module">
        const messages = [
            {
                title: "1. Lucha Contra la Corrupción",
                content: [
                    "Tráfico de influencia de contra autoridades tan a familiares sin examen de competencia. Complicidad de decano y director de carrera.",
                    "La obstaculización de decanatura a todos los trámites mediante objeciones sistemáticas.",
                    "Rectorado y decanato llevaron el proyecto Key Lab convenio con Corea del Sur para IA a la Facultad de ingeniería ya la Técnica"
                ]
            },
            {
                title: "2. Fortalecer la Institución: Académico",
                content: [
                    "Continuidad de los 7 nuevos planes ya implementadas",
                    "Apoyar a docentes y estudiantes en material académico",
                    "Mejorar los cursos de temporada en consenso con docentes y estudiantes",
                    "Evaluar y acreditar nuestros programas académicos, y actualizar los planes",
                    "Impulsar el Plan Estratégico de la Carrera PEI"
                ]
            },
            {
                title: "3. Fortalecer la Institución: Tecnológico",
                content: [
                    "Mejoramiento de la red inalámbrica, mas Internet para Informática",
                    "Mejoramiento de laboratorios para uso de estudiantes",
                    "Mejorar acceso uso de tecnologías en Data Center para aplicaciones CLOUD, y la Carrera pueda contar con su propia Nube de Informática",
                    "Potenciar recursos para IA",
                    "Fortalecer la Radio OPEN Informática, para los estudiantes, y puedan mostrar sus productos en extensión universitaria"
                ]
            },
            {
                title: "4. Económico: Recuperar los recursos del Pre facultativo",
                content: [
                    "Continuar la lucha y recuperar los recursos del Pre facultativo en su mayoría generados por postulantes a informática",
                    "La decanatura se queda con el 100% de los recursos generados en cursos pre universitarios.",
                    "Se calcula que el pre universitario o pre facultativo genera mas de 2 millones de bolivianos por gestión, los cuales se estarían gastando desde decanatura en complicidad con rectorado en preparación de la campaña rectoral del 2027",
                    "Las contrataciones que haría decanato serían de personal político dirigido a campañas políticas.",
                    "Transparentaremos el uso de esos recursos."
                ]
            },
            {
                title: "5. Posgrado y Facultización",
                content: [
                    "Continuar la lucha histórica por la facultización de Informática, somos la segunda carrera mas grande de la UMSA",
                    "Continuar la lucha por nuestra institución pese a las adversidades y contra el decano de turno.",
                    "El uso arbitrario de los recursos de posgrado de informática, el decano uso mas de Bs. 100.000.- el 2024 para gastos de decanatura.",
                    "Nunca olvidaremos que el 2013 con la Licenciada Elizabeth Garcia había 1,300,000.- para compra de un edificio de posgrado, dinero que desapareció en área desconcentrada de decanato. Memoriam a la Querida Colega."
                ]
            }
        ];

        let currentMessage = null;
        const jumpBtn = document.getElementById('jumpBtn');
        const mario = document.getElementById('mario');
        const block = document.getElementById('block');
        const scoreDisplay = document.getElementById('score');
        let isJumping = false;
        let messageQueue = [];
        let currentMessageIndex = 0;

        // Inicializar cola de mensajes en el orden definido (1..N)
        function initializeMessageQueue() {
            // Copiamos el arreglo tal cual para preservar el orden
            messageQueue = [...messages];
            currentMessageIndex = 0;
        }

        // Obtener siguiente mensaje en orden (1..N) y reiniciar al terminar
        function getNextMessage() {
            if (currentMessageIndex >= messageQueue.length) {
                // Reiniciar el índice para volver a mostrar desde el principio
                currentMessageIndex = 0;
            }
            return messageQueue[currentMessageIndex++];
        }

        // Sonido de salto original de Mario Bros
        function createJumpSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            oscillator.type = 'square';
            oscillator.frequency.setValueAtTime(1046, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(1318, audioContext.currentTime + 0.1);

            gainNode.gain.setValueAtTime(0.15, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.15);

            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.15);
        }

        // Sonido de golpear bloque original de Mario Bros
        function createHitSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            oscillator.type = 'square';
            const times = [0, 0.05, 0.1, 0.15];
            const freqs = [987, 1174, 1396, 1568];

            oscillator.frequency.setValueAtTime(freqs[0], audioContext.currentTime);
            for (let i = 1; i < times.length; i++) {
                oscillator.frequency.setValueAtTime(freqs[i], audioContext.currentTime + times[i]);
            }

            gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);

            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.2);
        }

        // Inicializar cola de mensajes al cargar
        initializeMessageQueue();

        jumpBtn.addEventListener('click', function () {
            if (isJumping) return;

            isJumping = true;
            mario.classList.add('jumping');

            // Reproducir sonido de salto solo una vez por clic
            createJumpSound();

            setTimeout(() => {
                hitBlock();
            }, 420); // Ligeramente más tarde para mejor efecto visual

            setTimeout(() => {
                mario.classList.remove('jumping');
                isJumping = false;
            }, 820);
        });

        function hitBlock() {
            block.classList.add('hit');

            // Reproducir sonido de golpe
            createHitSound();

            const nextMessage = getNextMessage();
            showMessage(nextMessage);

            setTimeout(() => {
                block.classList.remove('hit');
            }, 500);
        }

        function showMessage(messageData) {
            if (currentMessage) {
                currentMessage.remove();
            }

            const messageDiv = document.createElement('div');
            messageDiv.className = 'message';

            // Ubicar el modal arriba del bloque, sin taparlo
            const blockRect = block.getBoundingClientRect();
            // El modal se ubicará 20px arriba del bloque
            let top = blockRect.top - (window.innerHeight * 0.6) - 20;
            if (top < 10) top = 10;
            messageDiv.style.top = top + 'px';

            let contentHTML = '<h3>' + messageData.title + '</h3><ul';
            messageData.content.forEach(item => {
                contentHTML += '<li>' + item + '</li>';
            });
            contentHTML += '</ul>';
            contentHTML += '<button class="close-btn" onclick="closeMessage()">✕</button>';

            messageDiv.innerHTML = contentHTML;
            document.getElementById('gameContainer').appendChild(messageDiv);
            currentMessage = messageDiv;
        }

        window.closeMessage = function () {
            if (currentMessage) {
                currentMessage.remove();
                currentMessage = null;
            }
        };
    </script>
</body>

</html>